---
import { Image } from "astro:assets";
import { type CollectionEntry, getCollection } from "astro:content";
import {
	Card,
	CardContent,
	CardDescription,
	CardHeader,
	CardTitle,
} from "@/components/ui/card";
import Layout from "@/layouts/layout.astro";

const projects = await getCollection("projects");
---

<Layout title="Projects">
  <div class="container-page pb-14 pt-10">
    <header class="space-y-2">
      <h1 class="text-3xl font-semibold tracking-tight">Projects</h1>
      <p class="max-w-2xl text-sm leading-relaxed text-foreground/70">
        A small selection of things Iâ€™ve built.
      </p>
    </header>

    <div class="mt-8 flex flex-col gap-4">
      {projects.map((p: CollectionEntry<'projects'>) => (
        <a href={`/projects/${p.slug}`} class="w-full transition-opacity hover:opacity-90">
          <Card className="w-full border-foreground/10 bg-card/70 shadow-xs">
            <CardHeader>
              <CardTitle>
                {p.data.title}
              </CardTitle>
              <CardDescription>
                {p.data.subtitle}
              </CardDescription>
            </CardHeader>
            <CardContent className="flex flex-col gap-3 text-sm text-foreground/70">
              <p>{p.data.excerpt}</p>
              {p.data.image && (
                <div class="overflow-hidden rounded-lg border border-foreground/10">
                  <Image
                    src={p.data.image}
                    alt={p.data.title}
                    class="aspect-video w-full object-cover"
                    height={p.data.imageHeight!}
                    width={p.data.imageWidth!}
                  />
                </div>
              )}
            </CardContent>
          </Card>
        </a>
      ))}
    </div>
  </div>
</Layout>
